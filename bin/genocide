#!/usr/bin/env python3
# This file is placed in the Public Domain.


import os, sys ; sys.path.insert(0, os.getcwd())


import os
import sys
import termios
import time


wd = os.path.expanduser("~/.genocide")


from genocide.obj import keys
from genocide.run import Client, Runtime
from genocide.tbl import Table
from genocide.trc import get_exception


class Kernel(Runtime):

    def error(self, txt):
        print(txt)
        sys.stdout.flush()
        
    def log(self, txt):
        print(txt)
        sys.stdout.flush()


class CLI(Client):

    def raw(self, txt):
        print(txt)
        sys.stdout.flush()

clt = CLI()
k = Kernel()
tbl = Table()


import genocide.all


def main():
    k.boot()
    t.scan("genocide")
    if k.cfg.txt:
        return k.cmd(k.cfg.otxt)
    k.start()
    k.init(k.cfg.m)
    k.wait()

main()
