#!/usr/bin/env python3
# This file is placed in the Public Domain.


import os
import subprocess
import sys


os.environ["PATH"] += ":bin"


def popen(txt):
    proc = subprocess.Popen(
                            txt.split(),
                            stdin=sys.stdin,
                            stdout=sys.stdout,
                            stderr=sys.stderr,
                            close_fds=False,
                            text=True
                           )
    proc.communicate()
    proc.wait()


popen("clean")


if not os.path.exists("env"):
    popen("mkenv")


if not os.path.exists("env/bin/sphinx-build"):
    popen("upenv")

#popen("env/bin/python3 -m pip install -r docs/requirements.txt --upgrade --force-reinstall --no-cache-dir --no-deps")
popen("env/bin/python3 env/bin/sphinx-build docs html")
